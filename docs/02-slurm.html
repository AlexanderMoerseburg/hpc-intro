<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>02-slurm.utf8</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="assets/styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-sm-12 col-md-4 col-lg-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-sm-12 col-md-8 col-lg-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"><img id="logo" style="height: 25px;" src="assets/img/logo.svg" /></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="99-setup.html">Setup</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Materials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Under Development</li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Extras
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="99-unix_cheatsheet.html">Unix Cheatsheet</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/cambiotraining">
    <span class="fas fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">




</div>


<div id="overview" class="section level2">
<h2>Overview</h2>
<div class="tip">
<h4 id="questions">Questions</h4>
<h4 id="lesson-objectives">Lesson Objectives</h4>
<ul>
<li>Understand the role of a job scheduler</li>
<li>Submit a simple job and analyse its output</li>
<li>Edit a job submission script to request non-default resources</li>
<li>Understand SLURM environment variables</li>
</ul>
</div>
</div>
<div id="job-scheduler-overview" class="section level2">
<h2>Job Scheduler Overview</h2>
<div class="figure">
<img src="https://carpentries-incubator.github.io/hpc-intro/fig/restaurant_queue_manager.svg" alt="" />
<p class="caption">Scheduler Cartoon</p>
</div>
<p>HPC servers often have a <em>job scheduling</em> software to manages all the jobs that the users submit to be run on the <em>compute nodes</em>. This allows efficient usage of the compute resources (CPUs and RAM), and the user does not have to worry about affecting other people’s jobs.</p>
<p>The job scheduler uses an algorithm to prioritise the jobs, weighing aspects such as:</p>
<ul>
<li>how much time did you request to run your job?</li>
<li>how many resources (CPUs and RAM) do you need?</li>
<li>how many other jobs have you got running at the moment?</li>
</ul>
<p>Based on these, the algorithm will rank each of the jobs in the queue to decide on a “fair” way to prioritise them. Note that this priority dynamically changes all the time, as jobs are submitted or cancelled by the users, and depending on how long they have been in the queue. For example, a job requesting many resources may start with a low priority, but as it waits it will progressively increase its priority.</p>
</div>
<div id="submitting-a-minimal-job" class="section level2">
<h2>Submitting a Minimal Job</h2>
<p>In this workshop we will use the job scheduler called <a href="https://slurm.schedmd.com/documentation.html">SLURM</a>. This is a popular job scheduler in use across many HPC servers. However, the principles covered here apply to different scheduler software as well.</p>
<p>To submit a job to SLURM, you need to include your code in a <em>shell script</em>. Let’s start with a minimal example. Let’s say we have a script called <code>test_job.sh</code> with the following code:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="bu">echo</span> <span class="st">&quot;This job is running on:&quot;</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">hostname</span></span></code></pre></div>
<p>We can run this script <em>locally</em> using the common <code>bash</code> interpreter from our console:</p>
<pre><code>[participant@login-node: ~]$ bash test_job.sh</code></pre>
<p>Which prints the output:</p>
<pre><code>This job is running on:
login-node</code></pre>
<p>To submit the job to the scheduler we instead use the <code>sbatch</code> command in a very similar way:</p>
<pre><code>[participant@login-node: ~]$ sbatch test_script.sh</code></pre>
<p>However, this time we are informed that the job is submitted but the output is not printed back on the console. Instead the output is sent to a file, by default named as <code>slurm-jobid.out</code>, where “jobid” is a number corresponding to the job ID assigned to the job by the scheduler. This file will be located in the same directory where you launched the job from.</p>
<p>We can investigate the output by looking inside the file, for example <code>cat slurm-jobid.out</code>.</p>
</div>
<div id="requesting-custom-resources" class="section level2">
<h2>Requesting Custom Resources</h2>
<p>Although the above example works, we didn’t specify any resources for our job, and so it ran with whichever defaults were assigned to it by SLURM.</p>
<p>Instead, we can customise our job by specifying options at the top of the script using the <code>#SBATCH</code> keyword, followed by the SLURM option.</p>
<p>Here is an example of the same job:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co">#SBATCH -A training                           # account name (used for billing)</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co">#SBATCH -J testing_slurm                      # job name</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co">#SBATCH -D /scratch/participant/hpc_workshop  # working directory</span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co">#SBATCH -o logs/test_job.log                 # output file</span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="co">#SBATCH -p skylake             # or skylake-himem</span></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co">#SBATCH -c 2                   # max 32 CPUs</span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="co">#SBATCH --mem-per-cpu=1000MB   # max 5980MB or 12030MB for skilake-himem</span></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="co">#SBATCH -t 00:02:00            # HH:MM:SS with maximum 12:00:00 for SL3 or 36:00:00 for SL2</span></span>
<span id="cb5-11"><a href="#cb5-11"></a></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="bu">echo</span> <span class="st">&quot;This is output to stdout&quot;</span></span>
<span id="cb5-13"><a href="#cb5-13"></a></span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="bu">echo</span> <span class="st">&quot;This is re-directed to a file of choice&quot;</span> <span class="op">&gt;</span> first_job_output.txt</span>
<span id="cb5-15"><a href="#cb5-15"></a></span>
<span id="cb5-16"><a href="#cb5-16"></a><span class="co"># SLURM defines some variables automatically, which can be useful when writing scripts</span></span>
<span id="cb5-17"><a href="#cb5-17"></a><span class="bu">echo</span> <span class="st">&quot;This is job was assigned </span><span class="va">$SLURM_CPUS_PER_TASK</span><span class="st"> CPUs.&quot;</span></span></code></pre></div>
<p>Let’s break this down:</p>
<ol style="list-style-type: decimal">
<li>The first line (<code>#!/bin/bash</code>) is called a <a href="https://en.wikipedia.org/wiki/Shebang_(Unix)"><em>shebang</em></a> and indicates which program should interpret this script. In this case, <em>bash</em> is the interpreter of <em>shell</em> scripts (there’s other shell interpreters, but that’s beyond what we need to worry about here). Basically just <strong>always have this as the first line of your script</strong>.</li>
<li>Lines starting with <code>#SBATCH</code> contain options for the <em>sbatch</em> program. These options are:
<ul>
<li><code>-A</code> is the billing account, needed if you’re using the Cambridge University HPC. You may have more than one (e.g. if you have different <a href="https://docs.hpc.cam.ac.uk/hpc/user-guide/policies.html#service-levels">service levels (SL)</a>, such as the free “SL3” and paid “SL2”), so pick the right one - check them with <code>mybalance</code>.</li>
<li><code>-J</code> defines a name for the job.</li>
<li><code>-D</code> defines the <em>working directory</em> used for this job.</li>
<li><code>-o</code> defines the file where the output that would normally be printed on the console is saved in. This is defined in relation to the working directory set above. (technically this will include both the <em>standard output</em> and <em>standard error</em>)</li>
<li><code>-c</code> is the number of CPUs you want to use for your job.</li>
<li><code>-t</code> is the time you need for your job to run. This is not always possible to know in advance, so if you’re unsure leave it blank. However, if you know your jobs are short, setting this option will make them start faster.</li>
<li><code>-p</code> is the <em>partition</em>, needed when using the Cambridge University HPC. There are two of these <code>skylake</code> and <code>skylake-himem</code>, which allow a maximum of 5980MB and 12030MB or RAM per CPU, respectively.</li>
<li><code>--mem-per-cpu=</code> defines how much RAM memory you want for your job. You can instead use the option <code>--mem</code> if you prefer to define the total memory you require for your job (but check the Billing details in the section below).</li>
</ul></li>
<li>The other lines are the commands that we actually want to run.
<ul>
<li>Any output that would have been printed on the console (the first and third <code>echo</code> commands) will now be put into the file specified with the <code>#SBATCH -o</code> option above.</li>
<li>Any output that is redirected to a specific file (the second <code>echo</code>) will create that file as normal.</li>
<li>There are some shell <em>environment variables</em> which SLURM creates that automatically store values that match the resources we request for our job. In the example above “$SLURM_CPUS_PER_TASK” will contain the value 2 because we requested 2 CPUs (<code>#SBATCH -c 2</code>)</li>
</ul></li>
</ol>
<div id="default-resource-options" class="section level3">
<h3>Default Resource Options</h3>
<p>If you don’t specify some of the options listed above, you will get the default set by the HPC admins. For example, in our training HPC the defaults you will get are:</p>
<ul>
<li>10 minutes of running time (equivalent to <code>-t 00:10:00</code>)</li>
<li><em>skylake</em> partition (equivalent to <code>-p skylake</code>)</li>
<li>1 CPU (equivalent to <code>-c 1</code>)</li>
<li>5980MB RAM (equivalent to <code>--mem=5980MB</code>)</li>
</ul>
</div>
</div>
<div id="checking-job-status" class="section level2">
<h2>Checking job status</h2>
<p>After submitting a job, you can check its status using:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># show job status</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="ex">squeue</span> -u <span class="op">&lt;</span>user<span class="op">&gt;</span></span>
<span id="cb6-3"><a href="#cb6-3"></a></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co"># show details about the job, such as the working directory and output directories</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="ex">scontrol</span> show job <span class="op">&lt;</span>jobid<span class="op">&gt;</span></span></code></pre></div>
<p>This gives you information about the job’s status, <code>PD</code> means it’s <em>pending</em> (waiting in the queue) and <code>R</code> means it’s <em>running</em>.</p>
</div>
<div id="cancel-a-job" class="section level2">
<h2>Cancel a job</h2>
<p>To cancel a job do:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># replace &lt;JOBID&gt; with the job ID from squeue</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="ex">scancel</span> <span class="op">&lt;</span>JOBID<span class="op">&gt;</span></span></code></pre></div>
</div>
<div id="checking-resource-usage" class="section level2">
<h2>Checking resource usage</h2>
<p>To check the statistics about a job:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1"></a><span class="ex">sacct</span> -o jobname,account,state,reqmem,maxrss,averss,elapsed -j <span class="op">&lt;</span>JOBID<span class="op">&gt;</span></span></code></pre></div>
<ul>
<li><code>jobname</code> is the job’s name</li>
<li><code>account</code> is the account used for the job</li>
<li><code>state</code> gives you the state of the job</li>
<li><code>reqmem</code> is the memory that you asked for (Mc is MB per core)</li>
<li><code>maxrss</code> is the maximum memory used during the job <em>per core</em></li>
<li><code>averss</code> is the average memory used <em>per core</em></li>
<li><code>elapsed</code> how much time it took to run your job</li>
</ul>
<p>This can help you determine suitable resources (e.g. RAM, time) next time you run a similar job.</p>
<p><strong>Note:</strong> this only works on the university HPC, not the SLCU one.</p>
</div>
<div id="check-account-details" class="section level2">
<h2>Check account details</h2>
<ul>
<li><code>mybalance</code> to check how many hours of usage you have available on your account(s)</li>
<li><code>quota</code> to check how much disk space you have available in <code>/home</code> and <code>/rds</code></li>
</ul>
<p><strong>Note:</strong> this only works on the university HPC, not the SLCU one.</p>
<div class="exercise">
<ul>
<li><p>Create a directory called <code>scripts</code> in <code>~/rds/hpc-work/projects/hpc_workshop</code></p></li>
<li><p>Copy the code above and save it in a shell script named <code>first_job.sh</code></p>
<ul>
<li>use the text editor on your machine and save the script using the mounted drive (as covered in the <a href="./01_move_data.md">previous lesson</a>)</li>
<li>don’t forget to modify the <code>-A</code> option with your billing account and adjust the <code>-o</code> path with your username</li>
</ul></li>
<li><p>Submit the script to SLURM using <code>sbatch</code></p></li>
<li><p>Check how many resources your previous job used.</p>
<ul>
<li>note: if you can’t remember the JOBID running <code>sacct</code> with no other options will show you which jobs were run by you recently.</li>
</ul></li>
</ul>
<details>
<p><summary>Answer</summary></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># submitting the job</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="ex">sbatch</span> ~/rds/hpc-work/hpc_workshop/scripts/first_job.sh</span></code></pre></div>
</details>
</div>
</div>
<div id="summary" class="section level2">
<h2>Summary</h2>
<div class="tip">
<h4 id="further-resources">Further resources</h4>
<ul>
<li><a href="https://slurm.schedmd.com/pdfs/summary.pdf">SLURM cheatsheet</a></li>
</ul>
<h4 id="key-points">Key Points</h4>
<ul>
<li>list</li>
<li>them</li>
</ul>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
